# 1.2 HTML parser

## 前言

在上一节 [1.1 Virtual Dom](./1.1.md) 说到，手工构造一个 VNode 树效率低，可读性也不好：

```javascript
var ul =
    c('ul', [
      c('li', [ t("Item 1") ]),
      c('li', [ t("Item 2") ]),
      c('li', [ t("Item 3") ])
    ])
```

我们更希望有一个 `compile` 函数把字符串编译成对应的 VNode 对象

```javascript
var html = 
    `<ul>
      <li>Item 1</li>
      <li>Item 2</li>
      <li>Item 3</li>
    </ul>`

var ul = compile(html)
```

## 解析字符串 生成 HTMLElment 树 

ss

## 从 HTMLElment 到 AST 树

sss

## 从字符串到 VNode 树

xs

## 代码整理

当前分支新增的 shared 目录放置公共辅助函数，其他和 parser 相关的编译器代码都放在 src/compiler 目录下，包括：

```
1. codegen/index.js			(把 AST树 生成 VNode 树)
2. parser/html-parser.js 	(把 String 解析成 HTMLElement 树)
3. index.js 				(把 String 树生成 AST 树) 
```

前边我们提到的 ```compile``` 函数就通过以下得到：

```javascript
import parse from 'compiler/index'
import generate from 'compiler/codegen/index'

var compile = function(html){
  // 1. 先用 parse 把 String 树生成 AST 树
  // 2. 再用 generate 把 AST树 生成 VNode 树
  return generate(parse(html))
}
```

番外篇：当前1.2分支在解析 HTML 还没有处理兼容问题，我把相关的代码放在分支1.2.1，如果对这个有兴趣的话，可以 [点击查看分支 1.2.1 代码](https://github.com)

## 后续

有了这两节的代码基础，我们就可以构造一个简单的 Vue 类了，下一节会介绍基本的数据绑定以及如何书写一个 Vue 类的构造器。

